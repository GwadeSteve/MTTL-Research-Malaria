\begin{tikzpicture}[
    node distance=1.3cm and 1.5cm,
    block/.style={rectangle, draw, thick, fill=violet!20, rounded corners, minimum width=3cm, minimum height=0.8cm, align=center, font=\sffamily\small},
    feat_map/.style={cuboid, cuboidfill, minimum width=2.5cm, minimum height=0.55cm, font=\sffamily\tiny, fill=orange!30},
    op/.style={circle, draw, thick, fill=gray!10, minimum size=0.8cm, font=\sffamily\small},
    out_map/.style={cuboid, fill=green!25, minimum width=1.5cm, minimum height=0.4cm, font=\sffamily\tiny},
    arrow/.style={-Stealth, thick, draw=black!70}, % Sharp lines
    dim_label_right/.style={midway, right, font=\tiny\ttfamily, text=black!60, xshift=2mm}
]
    
    % --- TITLE ---
    \node[blocktitle] (title) {};
    
    % --- INPUTS ---
    \node[feat_map, below=0.8cm of title] (c1) {C1\\128×128×256};
    \node[feat_map, right=3cm of c1] (c2) {C2\\64×64×512};

    % --- PROJECTION & FUSION PATH ---
    \node[block, below=of c1] (proj1) {Conv 1x1};
    \node[block, below=of c2] (proj2) {Conv 1x1};
    \node[block, below=of proj2] (upsample) {Upsample (Bilinear)};
    
    \node[op, shape=cylinder, shape border rotate=90, minimum height=0.9cm, fill=cyan!20, below left=0.8cm and 0.5cm of upsample] (concat) {Concat};

    % --- ATTENTION PATH ---
    \node[block, below=1.2cm of concat, fill=yellow!25] (attention) {Spatial Attention};
    \node[op, right=1.2cm of attention, fill=yellow!30] (multiply) {$\times$};

    % --- DECODER PATH (with uniform spacing) ---
    \newcommand{\decoderVspace}{0.8cm} 
    
    \node[block, below=1.2cm of multiply, fill=blue!15] (sep_conv1) {Separable Conv Block};
    \node[block, below=\decoderVspace of sep_conv1, fill=blue!15] (sep_conv2) {Separable Conv Block};
    \node[block, below=\decoderVspace of sep_conv2, fill=blue!15] (final_conv) {Conv 1x1};
    \node[block, below=\decoderVspace of final_conv, fill=blue!15] (relu) {ReLU};
    \node[block, below=\decoderVspace of relu, fill=green!20] (sigmoid) {Sigmoid};

    % --- OUTPUT ---
    \node[out_map, below=\decoderVspace of sigmoid] (output) {Heatmap};
    
    % --- ARROWS & DIMENSIONS ---
    \draw[arrow] (c1) -- node[dim_label_right] {128×128×256} (proj1);
    \draw[arrow] (c2) -- node[dim_label_right] {64×64×512} (proj2);
    
    \draw[arrow] (proj1.south) -- ++(0,-0.4) -| node[dim_label_right] {128×128×64} (concat.west);
    \draw[arrow] (proj2.south) -- node[dim_label_right] {64×64×64} (upsample);
    \draw[arrow] (upsample.south) -- ++(0,-0.4) -| node[dim_label_right] {128×128×64} (concat.east);
    
    \draw[arrow] (concat.south) -- node[dim_label_right] {128×128×128} (attention.north);
    \draw[arrow] (concat.south) -- ++(0,-0.6) -| (multiply.west);
    \draw[arrow, draw=yellow!60!black] (attention.east) -- node[midway, above, font=\sffamily\tiny] {Att Map} (multiply);
    
    \draw[arrow] (multiply.south) -- node[dim_label_right] {128×128×128} (sep_conv1.north);
    \draw[arrow] (sep_conv1.south) -- node[dim_label_right] {128×128×64} (sep_conv2.north);
    \draw[arrow] (sep_conv2.south) -- node[dim_label_right] {128×128×32} (final_conv.north);
    \draw[arrow] (final_conv.south) -- node[dim_label_right] {128×128×1} (relu.north);
    \draw[arrow] (relu.south) -- (sigmoid.north);
    \draw[arrow] (sigmoid.south) -- node[dim_label_right] {64×64×1} (output.north);
    
    % --- ZONES & GROUPING ---
    \begin{scope}[on background layer]
        % Group for Decoder Path
        \node[draw=blue!50, fill=blue!5, rounded corners, inner sep=6pt,
              fit=(sep_conv1) (sep_conv2) (final_conv) (relu),
              label={[font=\sffamily\bfseries\tiny, text=blue!80!black]135:Decoder Path}] {};

        % Group for C1 Path
        \node[draw=violet!50, fill=violet!5, rounded corners, inner sep=8pt,
              fit=(c1) (proj1),
              label={[font=\sffamily\bfseries\tiny, text=violet!80!black]135:C1 Path}] {};
        
        % Group for C2 Path
        \node[draw=violet!50, fill=violet!5, rounded corners, inner sep=8pt,
              fit=(c2) (proj2) (upsample),
              label={[font=\sffamily\bfseries\tiny, text=violet!80!black]135:C2 Path}] {};
    \end{scope}
    
\end{tikzpicture}