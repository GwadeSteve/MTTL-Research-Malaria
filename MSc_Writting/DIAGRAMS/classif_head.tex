\begin{minipage}{0.48\textwidth}
    \centering
    \begin{tikzpicture}[
        node distance=0.7cm,
        block/.style={rectangle, draw, thick, fill=violet!20, rounded corners, minimum width=3.5cm, minimum height=0.8cm, align=center, font=\sffamily\small},
        feat_vec/.style={rectangle, draw, thick, fill=orange!30, rounded corners, minimum height=1.5cm, minimum width=0.5cm},
        out_vec/.style={feat_vec, fill=green!25},
        arrow/.style={-Stealth, thick, draw=black!70},
        dim_label_right/.style={midway, right, font=\tiny\ttfamily\bfseries, text=black!60, xshift=2mm}
    ]

        % Title
        \node[blocktitle] (title) {};

        % Input
        \node[feat_vec, below=1cm of title] (input_vec) {};
        \node[above=0.1cm of input_vec, font=\sffamily\small] {Global Feature Vector};

        % MLP Layers
        \node[block, below=of input_vec] (fc1) {Linear 2048→256};
        \node[block, below=of fc1, fill=blue!15] (norm1) {LayerNorm};
        \node[block, below=of norm1, fill=blue!15] (relu1) {ReLU};
        \node[block, below=of relu1, fill=gray!20] (dropout1) {Dropout 0.25};
        \node[block, below=of dropout1] (fc2) {Linear 256→128};
        \node[block, below=of fc2, fill=blue!15] (norm2) {LayerNorm};
        \node[block, below=of norm2, fill=blue!15] (relu2) {ReLU};
        \node[block, below=of relu2, fill=gray!20] (dropout2) {Dropout 0.25};
        \node[block, below=of dropout2] (fc3) {Linear 128→N};

        % Output
        \node[out_vec, below=of fc3] (output_vec) {};
        \node[above=0.1cm of output_vec, font=\sffamily\small] {Logits};

        % Arrows with full dimensions
        \draw[arrow] (input_vec) -- node[dim_label_right] {B × 2048} (fc1);
        \draw[arrow] (fc1) -- node[dim_label_right] {B × 256} (norm1);
        \draw[arrow] (norm1) -- node[dim_label_right] {B × 256} (relu1);
        \draw[arrow] (relu1) -- node[dim_label_right] {B × 256} (dropout1);
        \draw[arrow] (dropout1) -- node[dim_label_right] {B × 128} (fc2);
        \draw[arrow] (fc2) -- node[dim_label_right] {B × 128} (norm2);
        \draw[arrow] (norm2) -- node[dim_label_right] {B × 128} (relu2);
        \draw[arrow] (relu2) -- node[dim_label_right] {B × 128} (dropout2);
        \draw[arrow] (dropout2) -- node[dim_label_right] {B × N} (fc3);
        \draw[arrow] (fc3) -- node[dim_label_right] {B × N} (output_vec);

    \end{tikzpicture}
\end{minipage}%
\hfill
% --- RIGHT: RoI Classification Head ---
\begin{minipage}{0.48\textwidth}
    \centering
    \begin{tikzpicture}[
        node distance=0.7cm,
        block/.style={rectangle, draw, thick, fill=violet!20, rounded corners, minimum width=3.5cm, minimum height=0.8cm, align=center, font=\sffamily\small},
        feat_vec/.style={rectangle, draw, thick, fill=orange!30, rounded corners, minimum height=1cm, minimum width=1cm},
        out_vec/.style={feat_vec, fill=green!25},
        arrow/.style={-Stealth, thick, draw=black!70},
        proposal_arrow/.style={-Stealth, thick, draw=red!70!black, dashed, font=\sffamily\tiny},
        dim_label_right/.style={midway, right, font=\tiny\ttfamily\bfseries, text=black!60, xshift=2mm}
    ]

        % Title
        \node[blocktitle] (title) {};

        % Inputs
        \node[feat_vec, below=0.8cm of title] (p2) {P2};
        \node[feat_vec, right=0.4cm of p2] (p3) {P3};
        \node[feat_vec, right=0.4cm of p3] (p4) {P4};
        \node[above=0.2cm of p3, font=\sffamily\small] {FPN Feature Maps};

        % Proposals
        \node[rectangle, draw, thick, dashed, draw=red!70!black, rounded corners, below=0.6cm of p3] (proposals) {Region Proposals};

        % RoI Pooling
        \node[block, fill=blue!15, below=0.8cm of proposals] (roi_align) {MultiScaleRoIAlign};
        \node[block, fill=gray!20, below=of roi_align] (flatten) {Flatten};

        % MLP
        \node[block, below=of flatten] (mlp1) {Linear 3136→256};
        \node[block, below=of mlp1, fill=blue!15] (norm1) {BatchNorm};
        \node[block, below=of norm1, fill=blue!15] (relu1) {ReLU};
        \node[block, below=of relu1, fill=gray!20] (dropout1) {Dropout 0.4};
        \node[block, below=of dropout1] (mlp2) {Linear 256→128};
        \node[block, below=of mlp2, fill=blue!15] (norm2) {BatchNorm};
        \node[block, below=of norm2, fill=blue!15] (relu2) {ReLU};
        \node[block, below=of relu2, fill=gray!20] (dropout2) {Dropout 0.3};
        \node[block, below=of dropout2] (mlp3) {Linear 128→N};

        % Output
        \node[out_vec, below=of mlp3] (output_vec) {};
        \node[above=0.1cm of output_vec, font=\sffamily\small] {Logits};

        % Arrows with full dimensions
        \draw[arrow] (p2) -- node[dim_label_right] {} (roi_align);
        \draw[arrow] (p3) -- node[dim_label_right] {} (roi_align);
        \draw[arrow] (p4) -- node[dim_label_right] {} (roi_align);
        \draw[proposal_arrow] (proposals) -- node[dim_label_right] {RoIs × 4 (x1,y1,x2,y2)} (roi_align);
        \draw[arrow] (roi_align) -- node[dim_label_right] {RoIs × 64 × 7 × 7} (flatten);
        \draw[arrow] (flatten) -- node[dim_label_right] {RoIs × 3136} (mlp1);
        \draw[arrow] (mlp1) -- node[dim_label_right] {RoIs × 256} (norm1);
        \draw[arrow] (norm1) -- node[dim_label_right] {RoIs × 256} (relu1);
        \draw[arrow] (relu1) -- node[dim_label_right] {RoIs × 256} (dropout1);
        \draw[arrow] (dropout1) -- node[dim_label_right] {RoIs × 128} (mlp2);
        \draw[arrow] (mlp2) -- node[dim_label_right] {RoIs × 128} (norm2);
        \draw[arrow] (norm2) -- node[dim_label_right] {RoIs × 128} (relu2);
        \draw[arrow] (relu2) -- node[dim_label_right] {RoIs × 128} (dropout2);
        \draw[arrow] (dropout2) -- node[dim_label_right] {RoIs × N} (mlp3);
        \draw[arrow] (mlp3) -- node[dim_label_right] {RoIs × N} (output_vec);

    \end{tikzpicture}
\end{minipage}
