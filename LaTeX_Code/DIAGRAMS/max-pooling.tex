\begin{figure}[htbp]
\centering
\begin{tikzpicture}[
    scale=0.8, every node/.style={scale=0.8, font=\footnotesize, align=center},
    input_cell/.style={rectangle, draw, minimum size=0.7cm, inner sep=2pt, fill=gray!10},
    max_val_cell_style/.style={fill=yellow!50, font=\bfseries\Large}, % Style for the max value, larger font
    output_cell/.style={rectangle, draw, minimum size=0.7cm, inner sep=2pt, fill=red!20},
    window_highlight/.style={draw=blue, thick, dashed, inner sep=-0.5pt, rounded corners=1pt},
    arrow_style/.style={-Stealth, thick, shorten >=1pt, shorten <=1pt, gray}
  ]

    \node[above=0.2cm, font=\small] (input_label) at (1,2.5) {Input Feature Map (4x4)};
    \matrix (input_map) [matrix of nodes, nodes={input_cell},
                         column sep=-\pgflinewidth, row sep=-\pgflinewidth,
                         anchor=center] at (1,1) {
      1 & 2 & 6 & 3 \\
      3 & 5 & 2 & 1 \\
      1 & 2 & 2 & 1 \\
      7 & 3 & 4 & 8 \\
    };

    \node at (input_map-2-2) [max_val_cell_style] {5};
    \node at (input_map-1-3) [max_val_cell_style] {6};
    \node at (input_map-4-1) [max_val_cell_style] {7};
    \node at (input_map-4-4) [max_val_cell_style] {8};

    \node[above=0.2cm, font=\small] (output_label) at (4.5,2.5) {Output Map (2x2)};
    \matrix (output_map) [matrix of nodes, nodes={output_cell},
                          column sep=-\pgflinewidth, row sep=-\pgflinewidth,
                          anchor=center] at (4.5,1) { 
      5 & 6 \\
      7 & 8 \\
    };

    \node [window_highlight, fit=(input_map-1-1) (input_map-2-2)] (w1) {};
    \draw[arrow_style] (w1) -- (output_map-1-1);

    \node [window_highlight, fit=(input_map-1-3) (input_map-2-4)] (w2) {};
    \draw[arrow_style] (w2) -- (output_map-1-2);

    \node [window_highlight, fit=(input_map-3-1) (input_map-4-2)] (w3) {};
    \draw[arrow_style] (w3) -- (output_map-2-1);

    \node [window_highlight, fit=(input_map-3-3) (input_map-4-4)] (w4) {};
    \draw[arrow_style] (w4) -- (output_map-2-2);

    \node[below=0.5cm of input_map.south, xshift=1.7cm, font=\small] {2x2 Max Pooling (Stride 2)};

\end{tikzpicture}
\caption{Max pooling with 2x2 windows from input to output.}
\label{fig:max_pooling_simple}
\end{figure}